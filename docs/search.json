[{"path":"/articles/sfaira_vignette.html","id":"sfaira-integeration","dir":"Articles","previous_headings":"","what":"Sfaira Integeration","title":"Public Data Integration using Sfaira","text":"vignette cover integration public database Sfaria.","code":""},{"path":"/articles/sfaira_vignette.html","id":"setup","dir":"Articles","previous_headings":"Sfaira Integeration","what":"Setup","title":"Public Data Integration using Sfaira","text":"public database, sfaira (Fischer et al. 2020) used, dataset model repository single-cell RNA-sequencing data. gives access 233 datasets human mouse 3 million cells total. can browse interactively : https://theislab.github.io/sfaira-portal/Datasets. Note annotated datasets downloaded! order use database, first need install . can easily done, running setup_sfaira() function first time. background use basilisik package establish conda environment sfaira dependencies installed. installation performed one single time, even close R session call setup_sfaira() . directory serves storage future downloaded datasets sfaira:","code":"setup_list <- SimBu::setup_sfaira(basedir = tempdir()) #> [1] \"Sucessfully loaded sfaira.\""},{"path":"/articles/sfaira_vignette.html","id":"creating-a-dataset","dir":"Articles","previous_headings":"Sfaira Integeration","what":"Creating a dataset","title":"Public Data Integration using Sfaira","text":"simulator package works internally defined data-structure: datasets now create dataset samples human pancreas using organisms tissues parameter. can provide single word (like ) example list tissues want download: c(\"pancreas\",\"lung\"). additional parameter assays parameter, subset database download datasets certain sequencing assays (examples Smart-seq2). name parameter used later give sample (cell) unique name. Currently three datasets sfaira human pancreas, cell-type annotation. package download automatically merge together single expression matrix streamlined annotation table, can use simulation. can happen, datasets sfaira (yet) ready automatic download, error message appear R, telling file download put . wish see datasets included sfaira can use following command: allows find specific IDs datasets, can download directly:","code":"ds_pancrease <- SimBu::dataset_sfaira_multiple(sfaira_setup = setup_list,                                                organisms = \"Homo sapiens\",                                                 tissues = \"pancreas\",                                                 name=\"human_pancreas\") all_datasets <- SimBu::sfaira_overview(setup_list = setup_list) head(all_datasets) #>                                                                                                id    author                       doi #> 1:                            homosapiens_liver_2019_10x3v2_popescu_001_10.1038/s41586-019-1652-y   Popescu 10.1038/s41586-019-1652-y #> 2:                 homosapiens_lungparenchyma_2019_10x3v2_madissoon_001_10.1186/s13059-019-1906-x Madissoon 10.1186/s13059-019-1906-x #> 3:                      homosapiens_esophagus_2019_10x3v2_madissoon_002_10.1186/s13059-019-1906-x Madissoon 10.1186/s13059-019-1906-x #> 4:                         homosapiens_spleen_2019_10x3v2_madissoon_003_10.1186/s13059-019-1906-x Madissoon 10.1186/s13059-019-1906-x #> 5:                              homosapiens_lung_2019_dropseq_braga_001_10.1038/s41591-019-0468-5     Braga 10.1038/s41591-019-0468-5 #> 6: homosapiens_lungparenchyma_2019_10x3transcriptionprofiling_braga_001_10.1038/s41591-019-0468-5     Braga 10.1038/s41591-019-0468-5 #>    annotated                          assay           organ     organism #> 1:      TRUE                      10x 3' v2           liver Homo sapiens #> 2:      TRUE                      10x 3' v2 lung parenchyma Homo sapiens #> 3:      TRUE                      10x 3' v2       esophagus Homo sapiens #> 4:      TRUE                      10x 3' v2          spleen Homo sapiens #> 5:      TRUE                       Drop-seq            lung Homo sapiens #> 6:      TRUE 10x 3' transcription profiling lung parenchyma Homo sapiens SimBu::dataset_sfaira(sfaira_id = 'homosapiens_lungparenchyma_2019_10x3v2_madissoon_001_10.1186/s13059-019-1906-x',                       sfaira_setup = setup_list,                       name = \"dataset_by_id\") #> [1] \"Starting to download dataset from Sfaria with id: homosapiens_lungparenchyma_2019_10x3v2_madissoon_001_10.1186/s13059-019-1906-x\" #> [1] \"Downloading datasets...\" #> [1] \"Streamlining features & meta-data...\" #> Using rownames for cell-IDs. #> Filtering genes... #> Created dataset. #> class: SummarizedExperiment  #> dim: 20195 57020  #> metadata(0): #> assays(1): counts #> rownames(20195): TSPAN6 TNMD ... LINC02498 MGC4859 #> rowData names(0): #> colnames(57020): dataset_by_id_1 dataset_by_id_2 ... dataset_by_id_57019 dataset_by_id_57020 #> colData names(5): cell_ID cell_ID.old cell_type nReads_SimBu nGenes_SimBu sessionInfo() #> R version 4.1.0 (2021-05-18) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 18.04.6 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 #> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 #>  #> locale: #>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  #>  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #>  #> attached base packages: #> [1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #>  [1] SimBu_0.99.0                SummarizedExperiment_1.22.0 Biobase_2.52.0              GenomicRanges_1.44.0        #>  [5] GenomeInfoDb_1.28.4         IRanges_2.26.0              S4Vectors_0.30.2            BiocGenerics_0.38.0         #>  [9] MatrixGenerics_1.4.3        matrixStats_0.61.0          Matrix_1.3-4                #>  #> loaded via a namespace (and not attached): #>   [1] plyr_1.8.7              igraph_1.2.11           lazyeval_0.2.2          proxyC_0.2.4            splines_4.1.0           #>   [6] listenv_0.8.0           scattermore_0.8         ggplot2_3.3.5           digest_0.6.27           htmltools_0.5.2         #>  [11] fansi_1.0.3             magrittr_2.0.1          memoise_2.0.1           tensor_1.5              cluster_2.1.2           #>  [16] ROCR_1.0-11             globals_0.14.0          RcppParallel_5.1.5      pkgdown_2.0.2           spatstat.sparse_2.1-0   #>  [21] colorspace_2.0-3        ggrepel_0.9.1           xfun_0.30               dplyr_1.0.8             callr_3.7.0             #>  [26] crayon_1.5.1            RCurl_1.98-1.6          jsonlite_1.7.2          graph_1.70.0            spatstat.data_2.1-2     #>  [31] survival_3.2-11         zoo_1.8-9               glue_1.6.2              polyclip_1.10-0         gtable_0.3.0            #>  [36] zlibbioc_1.38.0         XVector_0.32.0          leiden_0.3.9            DelayedArray_0.18.0     future.apply_1.8.1      #>  [41] abind_1.4-5             scales_1.1.1            DBI_1.1.2               spatstat.random_2.1-0   miniUI_0.1.1.1          #>  [46] Rcpp_1.0.8.3            viridisLite_0.4.0       xtable_1.8-4            reticulate_1.24         spatstat.core_2.4-0     #>  [51] getopt_1.20.3           htmlwidgets_1.5.4       httr_1.4.2              dir.expiry_1.0.0        RColorBrewer_1.1-2      #>  [56] ellipsis_0.3.2          Seurat_4.1.0            ica_1.0-2               XML_4.0-0               pkgconfig_2.0.3         #>  [61] uwot_0.1.11             deldir_1.0-6            here_1.0.1              utf8_1.2.2              tidyselect_1.1.2        #>  [66] rlang_1.0.2             reshape2_1.4.4          later_1.3.0             biocViews_1.60.0        munsell_0.5.0           #>  [71] tools_4.1.0             cachem_1.0.6            cli_3.2.0               generics_0.1.2          ggridges_0.5.3          #>  [76] evaluate_0.14           stringr_1.4.0           fastmap_1.1.0           yaml_2.3.5              goftest_1.2-3           #>  [81] processx_3.5.3          knitr_1.33              fs_1.5.2                fitdistrplus_1.1-8      purrr_0.3.4             #>  [86] RANN_2.6.1              sparseMatrixStats_1.4.2 RBGL_1.68.0             pbapply_1.5-0           future_1.24.0           #>  [91] nlme_3.1-152            mime_0.10               xml2_1.3.3              rstudioapi_0.13         brio_1.1.3              #>  [96] compiler_4.1.0          curl_4.3.2              plotly_4.10.0           filelock_1.0.2          png_0.1-7               #> [101] testthat_3.1.2          spatstat.utils_2.3-0    tibble_3.1.6            stringi_1.6.1           ps_1.6.0                #> [106] basilisk.utils_1.4.0    desc_1.4.1              lattice_0.20-44         commonmark_1.8.0        vctrs_0.3.8             #> [111] stringdist_0.9.8        BiocCheck_1.28.0        pillar_1.7.0            lifecycle_1.0.1         RUnit_0.4.32            #> [116] BiocManager_1.30.16     optparse_1.7.1          spatstat.geom_2.3-2     lmtest_0.9-40           RcppAnnoy_0.0.19        #> [121] data.table_1.14.2       cowplot_1.1.1           bitops_1.0-7            irlba_2.3.5             httpuv_1.6.5            #> [126] patchwork_1.1.1         R6_2.5.1                promises_1.2.0.1        KernSmooth_2.23-20      gridExtra_2.3           #> [131] parallelly_1.30.0       codetools_0.2-18        MASS_7.3-54             assertthat_0.2.1        rprojroot_2.0.2         #> [136] withr_2.5.0             SeuratObject_4.0.4      sctransform_0.3.3       GenomeInfoDbData_1.2.6  mgcv_1.8-36             #> [141] grid_4.1.0              rpart_4.1-15            tidyr_1.2.0             basilisk_1.4.0          rmarkdown_2.13          #> [146] downlit_0.4.0           Rtsne_0.15              shiny_1.7.1"},{"path":"/articles/simulator_documentation.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting started with the pseudo-bulk simulator R package","text":"install package, run : (Since private repository, currently need authentication token repository.)","code":"install.packages(\"devtools\") devtools::install_github(\"omnideconv/SimBu\") #add auth_token=XXX to download from private repository library(SimBu)"},{"path":"/articles/simulator_documentation.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting started with the pseudo-bulk simulator R package","text":"Cell-type deconvolution important analysis-step processing bulk RNA-seq experiments many tools exist tackle issue. Though user lacks good comparison tools one might beneficial others. goal SimBu create benchmark datasets, pseudo bulk samples predefined cell-type fractions can simulated using expression data single-cell RNAseq experiments.","code":""},{"path":"/articles/simulator_documentation.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"Getting started with the pseudo-bulk simulator R package","text":"chapter covers need know quickly simulate pseudo-bulk samples! package can simulate samples local public data. vignette work artificially generated data serves overview features implemented SimBu. public data integration using sfaira (Fischer et al. 2020), please refer “Public Data Integration” vignette. create toy data use simulations; two matrices 300 cells 1000 genes/features. One represents raw count data, matrix represents scaled TPM-like data. assign cells immune cell types.","code":"counts <- Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell_\",rep(1:300)) colnames(tpm) <- paste0(\"cell_\",rep(1:300)) rownames(counts) <- paste0(\"gene_\",rep(1:1000)) rownames(tpm) <- paste0(\"gene_\",rep(1:1000))  annotation <- data.frame(\"ID\"=paste0(\"cell_\",rep(1:300)),                           \"cell_type\"=c(rep(\"T cells CD4\",50),                                         rep(\"T cells CD8\",50),                                        rep(\"Macrophages\",100),                                        rep(\"NK cells\",10),                                        rep(\"B cells\",70),                                        rep(\"Monocytes\",20)))"},{"path":"/articles/simulator_documentation.html","id":"creating-a-dataset","dir":"Articles","previous_headings":"Getting started","what":"Creating a dataset","title":"Getting started with the pseudo-bulk simulator R package","text":"SimBu uses SummarizedExperiment class storage count data well annotation data. Currently possible store two matrices time: raw counts TPM-like data (can also scaled count matrix, RPKM, recommend use TPMs). two matrices dimensions contain genes cells. Providing raw count data mandatory! SimBu scales matrix added via tpm_matrix slot default 1e6 per cell, want , can switch setting scale_tpm parameter FALSE. Additionally, cell type annotation cells given dataframe, include two columns ID cell_type. additional columns annotation transferred dataset, simply give names additional_cols parameter. generate dataset can used SimBu, can use dataset() method; methods exist well, covered “Inputs & Outputs” vignette. SimBu offers basic filtering options dataset, can apply dataset generation: filter_genes: TRUE, genes expression values 0 cells removed. variance_cutoff: remove genes expression variance chosen cutoff. type_abundance_cutoff: remove cells, belong cell type appears less given amount.","code":"ds <- SimBu::dataset(annotation = annotation,                      count_matrix = counts,                      tpm_matrix = tpm,                      name = \"test_dataset\") #> Filtering genes... #> Created dataset."},{"path":"/articles/simulator_documentation.html","id":"simulate-pseudo-bulk-datasets","dir":"Articles","previous_headings":"Getting started","what":"Simulate pseudo bulk datasets","title":"Getting started with the pseudo-bulk simulator R package","text":"now ready simulate first pseudo bulk samples created dataset: ncells sets number cells sample, nsamples sets total amount simulated samples. want simulate specific sequencing depth simulations, can use total_read_counts parameter . Note parameter applied counts matrix (supplied), TPMs scaled 1e6 default. SimBu can add mRNA bias using different scaling factors simulations using scaling_factor parameter. detailed explanation can found “Scaling factor” vignette. Currently 6 scenarios implemented package: even: creates samples, existing cell-types dataset appear proportions. using dataset 3 cell-types, simulate samples, cell-type fractions 1/3. order still slight variation cell type fractions, can increase balance_uniform_mirror_scenario parameter (default 0.01). Setting 0 generate simulations exactly cell type fractions. random: scenario create random cell type fractions using present types sample. random sampling based uniform distribution. mirror_db: scenario mirror exact fractions cell types present provided dataset. consists 20% T cells, 30% B cells 50% NK cells, simulated samples mirror fractions. Similar uniform scenario, can add small variation fractions balance_uniform_mirror_scenario parameter. weighted: need set two additional parameters simulate_bulk() function: weighted_cell_type sets cell-type want -representing weighted_amount sets fraction cell-type. example use B-cell 0.5 create samples, 50% B-cells rest filled randomly cell-types. pure: creates simulations one single cell-type. provide name cell-type pure_cell_type parameter. custom: able create set cell-type fractions. using scenario, additionally need provide dataframe custom_scenario_data parameter, row represents one sample (therefore number rows need match nsamples parameter). column represent one cell-type, also occurs dataset describes fraction cell-type sample. fractions per sample need sum 1. example can seen :","code":"simulation <- SimBu::simulate_bulk(data = ds,                                    scenario = \"random\",                                     scaling_factor = \"NONE\",                                     ncells=100,                                     nsamples = 10,                                     BPPARAM = BiocParallel::MulticoreParam(workers = 4),  #this will use 4 threads to run the simulation                                    run_parallel = TRUE)                                 #multi-threading to TRUE #> Using parallel generation of simulations. #> Finished simulation. pure_scenario_dataframe <- data.frame(   \"B cells\" = c(0.2, 0.1, 0.5, 0.3),   \"T cells\" = c(0.3, 0.8, 0.2, 0.5),   \"NK cells\" = c(0.5, 0.1, 0.3, 0.2),   row.names = c(\"sample1\",\"sample2\",\"sample3\",\"sample4\") ) pure_scenario_dataframe #>         B.cells T.cells NK.cells #> sample1     0.2     0.3      0.5 #> sample2     0.1     0.8      0.1 #> sample3     0.5     0.2      0.3 #> sample4     0.3     0.5      0.2"},{"path":"/articles/simulator_documentation.html","id":"results","dir":"Articles","previous_headings":"Getting started","what":"Results","title":"Getting started with the pseudo-bulk simulator R package","text":"simulation object contains three named entries: bulk: SummarizedExperiment object pseudo-bulk dataset(s) stored assays. can accessed like : single matrix given dataset initially, one assay filled. cell_fractions: table rows represent simulated samples columns represent different simulated cell-types. entries table store specific cell-type fraction per sample. scaling_vector: named list, used scaling value cell single cell dataset. also possible merge simulations: Finally barplot resulting simulation: plot chunk unnamed-chunk-9","code":"dim(SummarizedExperiment::assays(simulation$bulk)[[\"bulk_counts\"]]) #> [1] 1000   10 dim(SummarizedExperiment::assays(simulation$bulk)[[\"bulk_tpm\"]]) #> [1] 1000   10 simulation2 <- SimBu::simulate_bulk(data = ds,                                    scenario = \"even\",                                     scaling_factor = \"NONE\",                                     ncells=1000,                                     nsamples = 10,                                     BPPARAM = BiocParallel::MulticoreParam(workers = 4),                                      run_parallel = TRUE) #> Using parallel generation of simulations. #> Finished simulation.  merged_simulations <- SimBu::merge_simulations(list(simulation, simulation2)) SimBu::plot_simulation(simulation = merged_simulations)"},{"path":[]},{"path":"/articles/simulator_documentation.html","id":"simulate-using-a-whitelist-and-blacklist-of-cell-types","dir":"Articles","previous_headings":"More features","what":"Simulate using a whitelist (and blacklist) of cell-types","title":"Getting started with the pseudo-bulk simulator R package","text":"Sometimes, interested specific cell-types (example T cells), dataset using many cell-types; can handle issue simulation using whitelist parameter: plot chunk unnamed-chunk-10 way, can also provide blacklist parameter, name cell-types don’t want included simulation.","code":"simulation <- SimBu::simulate_bulk(data = ds,                                    scenario = \"random\",                                     scaling_factor = \"NONE\",                                     ncells=1000,                                     nsamples = 20,                                     BPPARAM = BiocParallel::MulticoreParam(workers = 4),                                      run_parallel = TRUE,                                    whitelist = c(\"T cells CD4\", \"T cells CD8\")) #> Using parallel generation of simulations. #> Finished simulation.  SimBu::plot_simulation(simulation = simulation) sessionInfo() #> R version 4.1.0 (2021-05-18) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 18.04.6 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 #> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 #>  #> locale: #>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  #>  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #>  #> attached base packages: #> [1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #>  [1] SimBu_0.99.0                SummarizedExperiment_1.22.0 Biobase_2.52.0              GenomicRanges_1.44.0        #>  [5] GenomeInfoDb_1.28.4         IRanges_2.26.0              S4Vectors_0.30.2            BiocGenerics_0.38.0         #>  [9] MatrixGenerics_1.4.3        matrixStats_0.61.0          Matrix_1.3-4                #>  #> loaded via a namespace (and not attached): #>   [1] utf8_1.2.2              reticulate_1.24         RUnit_0.4.32            tidyselect_1.1.2        htmlwidgets_1.5.4       #>   [6] grid_4.1.0              BiocParallel_1.26.2     Rtsne_0.15              munsell_0.5.0           codetools_0.2-18        #>  [11] ica_1.0-2               future_1.24.0           miniUI_0.1.1.1          withr_2.5.0             spatstat.random_2.1-0   #>  [16] colorspace_2.0-3        filelock_1.0.2          highr_0.9               knitr_1.33              rstudioapi_0.13         #>  [21] Seurat_4.1.0            ROCR_1.0-11             tensor_1.5              listenv_0.8.0           labeling_0.4.2          #>  [26] optparse_1.7.1          GenomeInfoDbData_1.2.6  polyclip_1.10-0         farver_2.1.0            rprojroot_2.0.2         #>  [31] basilisk_1.4.0          parallelly_1.30.0       vctrs_0.3.8             generics_0.1.2          xfun_0.30               #>  [36] R6_2.5.1                bitops_1.0-7            spatstat.utils_2.3-0    cachem_1.0.6            DelayedArray_0.18.0     #>  [41] assertthat_0.2.1        promises_1.2.0.1        scales_1.1.1            gtable_0.3.0            downlit_0.4.0           #>  [46] biocViews_1.60.0        globals_0.14.0          processx_3.5.3          goftest_1.2-3           rlang_1.0.2             #>  [51] splines_4.1.0           lazyeval_0.2.2          spatstat.geom_2.3-2     BiocManager_1.30.16     yaml_2.3.5              #>  [56] reshape2_1.4.4          abind_1.4-5             httpuv_1.6.5            RBGL_1.68.0             tools_4.1.0             #>  [61] ggplot2_3.3.5           ellipsis_0.3.2          spatstat.core_2.4-0     RColorBrewer_1.1-2      ggridges_0.5.3          #>  [66] Rcpp_1.0.8.3            plyr_1.8.7              sparseMatrixStats_1.4.2 zlibbioc_1.38.0         purrr_0.3.4             #>  [71] RCurl_1.98-1.6          basilisk.utils_1.4.0    ps_1.6.0                rpart_4.1-15            deldir_1.0-6            #>  [76] pbapply_1.5-0           cowplot_1.1.1           zoo_1.8-9               SeuratObject_4.0.4      ggrepel_0.9.1           #>  [81] cluster_2.1.2           fs_1.5.2                here_1.0.1              magrittr_2.0.1          data.table_1.14.2       #>  [86] scattermore_0.8         lmtest_0.9-40           RANN_2.6.1              fitdistrplus_1.1-8      patchwork_1.1.1         #>  [91] mime_0.10               evaluate_0.14           xtable_1.8-4            XML_4.0-0               gridExtra_2.3           #>  [96] testthat_3.1.2          compiler_4.1.0          tibble_3.1.6            KernSmooth_2.23-20      crayon_1.5.1            #> [101] htmltools_0.5.2         proxyC_0.2.4            mgcv_1.8-36             later_1.3.0             tidyr_1.2.0             #> [106] RcppParallel_5.1.5      DBI_1.1.2               MASS_7.3-54             getopt_1.20.3           brio_1.1.3              #> [111] cli_3.2.0               igraph_1.2.11           pkgconfig_2.0.3         pkgdown_2.0.2           dir.expiry_1.0.0        #> [116] plotly_4.10.0           spatstat.sparse_2.1-0   xml2_1.3.3              stringdist_0.9.8        XVector_0.32.0          #> [121] BiocCheck_1.28.0        stringr_1.4.0           callr_3.7.0             digest_0.6.27           sctransform_0.3.3       #> [126] RcppAnnoy_0.0.19        graph_1.70.0            spatstat.data_2.1-2     rmarkdown_2.13          leiden_0.3.9            #> [131] uwot_0.1.11             curl_4.3.2              shiny_1.7.1             commonmark_1.8.0        lifecycle_1.0.1         #> [136] nlme_3.1-152            jsonlite_1.7.2          desc_1.4.1              viridisLite_0.4.0       fansi_1.0.3             #> [141] pillar_1.7.0            lattice_0.20-44         fastmap_1.1.0           httr_1.4.2              survival_3.2-11         #> [146] glue_1.6.2              png_0.1-7               stringi_1.6.1           memoise_2.0.1           dplyr_1.0.8             #> [151] irlba_2.3.5             future.apply_1.8.1"},{"path":[]},{"path":"/articles/simulator_input_output.html","id":"input","dir":"Articles","previous_headings":"","what":"Input","title":"Inputs & Outputs","text":"input simulations always SummarizedExperiment object. can create object different constructing functions, explained . also possible merge multiple datasets objects one. Sfaira covered vignette, “Public Data Integration”.","code":""},{"path":"/articles/simulator_input_output.html","id":"custom-data","dir":"Articles","previous_headings":"Input","what":"Custom data","title":"Inputs & Outputs","text":"Using existing count matrices annotations already covered “Getting started” vignette; section explain minor details. generating dataset data, need provide count_matrix parameter dataset(); additionally can provide TPM matrix tpm_matrix. lead two simulations, one based counts one based TPMs. either , genes located rows, cells columns. Additionally, annotation table needed, cell-type annotations. needs consist least 2 columns: ID cell_type, ID identical column names provides matrix/matrices. cells appear annotation matrix, intersection used generate dataset. example data:","code":"counts <- Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell-\",rep(1:300)) colnames(tpm) <- paste0(\"cell-\",rep(1:300)) rownames(counts) <- paste0(\"gene-\",rep(1:1000)) rownames(tpm) <- paste0(\"gene-\",rep(1:1000))  annotation <- data.frame(\"ID\"=paste0(\"cell-\",rep(1:300)),                           \"cell_type\"=c(rep(\"T cells CD4\",50),                                         rep(\"T cells CD8\",50),                                        rep(\"Macrophages\",100),                                        rep(\"NK cells\",10),                                        rep(\"B cells\",70),                                        rep(\"Monocytes\",20)),                          row.names = paste0(\"cell-\",rep(1:300)))  seurat_obj <- Seurat::CreateSeuratObject(counts = counts, assay = 'counts', meta.data = annotation) tpm_assay <- Seurat::CreateAssayObject(counts = tpm) seurat_obj[['tpm']] <- tpm_assay  seurat_obj #> An object of class Seurat  #> 2000 features across 300 samples within 2 assays  #> Active assay: counts (1000 features, 0 variable features) #>  1 other assay present: tpm"},{"path":"/articles/simulator_input_output.html","id":"seurat","dir":"Articles","previous_headings":"Input > Custom data","what":"Seurat","title":"Inputs & Outputs","text":"possible use Seurat object build dataset; give name assay containing count data counts slot, name column meta table unique cell IDs name column meta table cell type identifier. Additionally may give name assay containing TPM data counts slot.","code":"ds_seurat <- SimBu::dataset_seurat(seurat_obj = seurat_obj,                                     count_assay = \"counts\",                                     cell_id_col = 'ID',                                     cell_type_col = 'cell_type',                                     tpm_assay = 'tpm',                                    name = \"seurat_dataset\") #> Filtering genes... #> Created dataset."},{"path":"/articles/simulator_input_output.html","id":"h5ad-files","dir":"Articles","previous_headings":"Input > Custom data","what":"h5ad files","title":"Inputs & Outputs","text":"possible use h5ad file directly, file format stores AnnData objects. h5ad files can store cell specific information obs layer, additional annotation input SimBu needed. Note: want counts tpm data input, provide two files; cell annotation match two files. SimBu expects cells columns genes/features rows input matrix, necessarily case anndata objects, SimBu can handle h5ad files cells obs var layer. cells obs, use cells_in_obs=TRUE FALSE otherwise. also automatically transpose matrix. know, columns cell annotation layer correspond cell identifiers cell type labels, use cell_id_col cell_type_col parameters, respectively. function uses SimBu python environment read h5ad files extract data, may take time initalize conda environment first usage .","code":"# example h5ad file, where cell type info is stored in `obs` layer h5 <- system.file('extdata', 'anndata.h5ad', package='SimBu') ds_h5ad <- SimBu::dataset_h5ad(h5ad_file_counts = h5,                                name = \"h5ad_dataset\",                                cell_id_col = 'ID',                  # this will use the 'ID' column of the metadata as cell identifiers                                cell_type_col = 'cell_type',         # this will use the 'cell_type' column of the metadata as cell type info                                cells_in_obs = TRUE)                 # in case your cell information is stored in the var layer, switch to FALSE #> Filtering genes... #> Created dataset."},{"path":"/articles/simulator_input_output.html","id":"merging-datasets","dir":"Articles","previous_headings":"Input","what":"Merging datasets","title":"Inputs & Outputs","text":"able merge multiple datasets using dataset_merge function:","code":"ds <- SimBu::dataset(annotation = annotation,                      count_matrix = counts,                      tpm_matrix = tpm,                      name = \"test_dataset\") #> Filtering genes... #> Created dataset.  ds_multiple <- SimBu::dataset_merge(dataset_list = list(ds_seurat, ds),                                     name = \"ds_multiple\") #> Filtering genes... #> Created dataset."},{"path":"/articles/simulator_input_output.html","id":"output","dir":"Articles","previous_headings":"","what":"Output","title":"Inputs & Outputs","text":"simulation object contains three named entries: bulk: SummarizedExperiment object pseudo-bulk dataset(s) stored assays. can accessed like : count matrix given dataset initially, bulk_counts assay filled. cell_fractions: table rows represent simulated samples columns represent different simulated cell-types. entries table store specific cell-type fraction per sample. scaling_vector: named list, used scaling value cell single cell dataset.","code":"simulation <- SimBu::simulate_bulk(data = ds_multiple,                                    scenario = \"random\",                                     scaling_factor = \"NONE\",                                    nsamples = 10, ncells = 100) #> Finished simulation.  dim(SummarizedExperiment::assays(simulation$bulk)[[\"bulk_counts\"]]) #> [1] 1000   10 dim(SummarizedExperiment::assays(simulation$bulk)[[\"bulk_tpm\"]]) #> [1] 1000   10 sessionInfo() #> R version 4.1.0 (2021-05-18) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 18.04.6 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 #> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 #>  #> locale: #>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  #>  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #>  #> attached base packages: #> [1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #>  [1] curl_4.3.2                  SeuratObject_4.0.4          Seurat_4.1.0                SimBu_0.99.0                #>  [5] SummarizedExperiment_1.22.0 Biobase_2.52.0              GenomicRanges_1.44.0        GenomeInfoDb_1.28.4         #>  [9] IRanges_2.26.0              S4Vectors_0.30.2            BiocGenerics_0.38.0         MatrixGenerics_1.4.3        #> [13] matrixStats_0.61.0          Matrix_1.3-4                #>  #> loaded via a namespace (and not attached): #>   [1] utf8_1.2.2              reticulate_1.24         RUnit_0.4.32            tidyselect_1.1.2        htmlwidgets_1.5.4       #>   [6] grid_4.1.0              BiocParallel_1.26.2     Rtsne_0.15              munsell_0.5.0           codetools_0.2-18        #>  [11] ica_1.0-2               future_1.24.0           miniUI_0.1.1.1          withr_2.5.0             spatstat.random_2.1-0   #>  [16] colorspace_2.0-3        filelock_1.0.2          highr_0.9               knitr_1.33              rstudioapi_0.13         #>  [21] ROCR_1.0-11             tensor_1.5              listenv_0.8.0           labeling_0.4.2          optparse_1.7.1          #>  [26] GenomeInfoDbData_1.2.6  polyclip_1.10-0         farver_2.1.0            rprojroot_2.0.2         basilisk_1.4.0          #>  [31] parallelly_1.30.0       vctrs_0.3.8             generics_0.1.2          xfun_0.30               R6_2.5.1                #>  [36] bitops_1.0-7            spatstat.utils_2.3-0    cachem_1.0.6            DelayedArray_0.18.0     assertthat_0.2.1        #>  [41] promises_1.2.0.1        scales_1.1.1            gtable_0.3.0            downlit_0.4.0           biocViews_1.60.0        #>  [46] globals_0.14.0          processx_3.5.3          goftest_1.2-3           rlang_1.0.2             splines_4.1.0           #>  [51] lazyeval_0.2.2          spatstat.geom_2.3-2     BiocManager_1.30.16     yaml_2.3.5              reshape2_1.4.4          #>  [56] abind_1.4-5             httpuv_1.6.5            RBGL_1.68.0             tools_4.1.0             ggplot2_3.3.5           #>  [61] ellipsis_0.3.2          spatstat.core_2.4-0     RColorBrewer_1.1-2      ggridges_0.5.3          Rcpp_1.0.8.3            #>  [66] plyr_1.8.7              sparseMatrixStats_1.4.2 zlibbioc_1.38.0         purrr_0.3.4             RCurl_1.98-1.6          #>  [71] basilisk.utils_1.4.0    ps_1.6.0                rpart_4.1-15            deldir_1.0-6            pbapply_1.5-0           #>  [76] cowplot_1.1.1           zoo_1.8-9               ggrepel_0.9.1           cluster_2.1.2           fs_1.5.2                #>  [81] here_1.0.1              magrittr_2.0.1          data.table_1.14.2       scattermore_0.8         lmtest_0.9-40           #>  [86] RANN_2.6.1              fitdistrplus_1.1-8      patchwork_1.1.1         mime_0.10               evaluate_0.14           #>  [91] xtable_1.8-4            XML_4.0-0               gridExtra_2.3           testthat_3.1.2          compiler_4.1.0          #>  [96] tibble_3.1.6            KernSmooth_2.23-20      crayon_1.5.1            htmltools_0.5.2         proxyC_0.2.4            #> [101] mgcv_1.8-36             later_1.3.0             tidyr_1.2.0             RcppParallel_5.1.5      DBI_1.1.2               #> [106] MASS_7.3-54             getopt_1.20.3           brio_1.1.3              cli_3.2.0               igraph_1.2.11           #> [111] pkgconfig_2.0.3         pkgdown_2.0.2           dir.expiry_1.0.0        plotly_4.10.0           spatstat.sparse_2.1-0   #> [116] xml2_1.3.3              stringdist_0.9.8        XVector_0.32.0          BiocCheck_1.28.0        stringr_1.4.0           #> [121] callr_3.7.0             digest_0.6.27           sctransform_0.3.3       RcppAnnoy_0.0.19        graph_1.70.0            #> [126] spatstat.data_2.1-2     rmarkdown_2.13          leiden_0.3.9            uwot_0.1.11             shiny_1.7.1             #> [131] commonmark_1.8.0        lifecycle_1.0.1         nlme_3.1-152            jsonlite_1.7.2          desc_1.4.1              #> [136] viridisLite_0.4.0       fansi_1.0.3             pillar_1.7.0            lattice_0.20-44         fastmap_1.1.0           #> [141] httr_1.4.2              survival_3.2-11         glue_1.6.2              png_0.1-7               stringi_1.6.1           #> [146] memoise_2.0.1           dplyr_1.0.8             irlba_2.3.5             future.apply_1.8.1"},{"path":"/articles/simulator_scaling_factors.html","id":"using-scaling-factors","dir":"Articles","previous_headings":"","what":"Using scaling factors","title":"Introducing mRNA bias into simulations with scaling factors","text":"package allows user introduce mRNA bias pseudo-bulk RNA-seq samples. Different cell-types contain different amounts mRNA (Dendritic cells examples contain much Neutrophils); bias can added simulations artificially different ways. scaling factors always applied single-cell dataset first, altering expression profiles accordingly, pseudo-bulk samples generated summing count data sampled cells.","code":"#Example data counts <-  Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell_\",rep(1:300)) colnames(tpm) <- paste0(\"cell_\",rep(1:300)) rownames(counts) <- paste0(\"gene_\",rep(1:1000)) rownames(tpm) <- paste0(\"gene_\",rep(1:1000))    annotation <- data.frame(\"ID\"=paste0(\"cell_\",rep(1:300)),                            \"cell_type\" = c(rep(\"T cells CD4\",150), rep(\"T cells CD8\",150)),                            'spikes' = runif(300),                            'add_1' = runif(300),                            'add_2' = runif(300))  ds <- SimBu::dataset(annotation = annotation,                      count_matrix = counts,                      name = \"test_dataset\") #> Filtering genes... #> Created dataset."},{"path":"/articles/simulator_scaling_factors.html","id":"pre-defined-scaling-factors","dir":"Articles","previous_headings":"Using scaling factors","what":"Pre-defined scaling factors","title":"Introducing mRNA bias into simulations with scaling factors","text":"studies proposed scaling factors immune cells, EPIC (Racle et al. 2017) quanTIseq (Finotello et al. 2019), deconvolution tools correct mRNA bias internally using values: want apply one scaling factors simulation (therefore -/decreasing expression signals cell-types), can use scaling_factor parameter. Note, pre-defined scaling factors offer values certain number cell types, annotation provided dataset match names 1:1. cell types dataset present scaling factor remain unscaled warning message appear. can also try custom scaling factors, example increasing expression levels single cell-type (T cells CD8) 10-fold compared rest. cell-types mentioned named list given custom_scaling_vector transformed scaling factor 1, meaning nothing changes . Important: Watch cell-type annotation names dataset scaling factor! Otherwise scaling factor applied even worse, applied different cell-type.","code":"epic <- data.frame(   type = c(\"B cells\",             \"Macrophages\",            \"Monocytes\",             \"Neutrophils\",            \"NK cells\",            \"T cells\",            \"T cells CD4\",            \"T cells CD8\",            \"T helper cells\",            \"T regulatory cells\",            \"otherCells\",            \"default\"),   mRNA = c(0.4016,            1.4196,            1.4196,            0.1300,            0.4396,            0.3952,            0.3952,            0.3952,            0.3952,            0.3952,            0.4000,            0.4000)    )  epic #>                  type   mRNA #> 1             B cells 0.4016 #> 2         Macrophages 1.4196 #> 3           Monocytes 1.4196 #> 4         Neutrophils 0.1300 #> 5            NK cells 0.4396 #> 6             T cells 0.3952 #> 7         T cells CD4 0.3952 #> 8         T cells CD8 0.3952 #> 9      T helper cells 0.3952 #> 10 T regulatory cells 0.3952 #> 11         otherCells 0.4000 #> 12            default 0.4000 quantiseq <- data.frame(   type = c(\"B cells\",            \"Macrophages\",            \"MacrophagesM2\",            \"Monocytes\",            \"Neutrophils\",            \"NK cells\",            \"T cells CD4\",            \"T cells CD8\",            \"T regulatory cells\",            \"Dendritic cells\",            \"T cells\"),   mRNA = c( 65.66148,             138.11520,             119.35447,             130.65455,             27.73634,             117.71584,             63.87200,             70.25659,             72.55110,             140.76091,             68.89323)    )  quantiseq #>                  type      mRNA #> 1             B cells  65.66148 #> 2         Macrophages 138.11520 #> 3       MacrophagesM2 119.35447 #> 4           Monocytes 130.65455 #> 5         Neutrophils  27.73634 #> 6            NK cells 117.71584 #> 7         T cells CD4  63.87200 #> 8         T cells CD8  70.25659 #> 9  T regulatory cells  72.55110 #> 10    Dendritic cells 140.76091 #> 11            T cells  68.89323 sim_epic <- SimBu::simulate_bulk(data=ds,                                  scenario = \"random\",                                  scaling_factor=\"epic\",                                  nsamples = 10,                                   ncells=100,                                  BPPARAM = BiocParallel::MulticoreParam(workers = 4),                                    run_parallel = TRUE) #> Using parallel generation of simulations. #> Using EPIC scaling factors. #> Finished simulation. sim_extreme_b <- SimBu::simulate_bulk(data = ds,                                        scenario = \"random\",                                       scaling_factor = \"custom\",                                       custom_scaling_vector = c(\"T cells CD8\"=10),                                        nsamples = 10,                                        ncells = 100,                                        BPPARAM = BiocParallel::MulticoreParam(workers = 4),                                         run_parallel = TRUE) #> Using parallel generation of simulations. #> Using custom scaling factors. #> Warning in merge_scaling_factor(data = data, scaling_factor_values = custom_scaling_vector, : For some cell type(s) in the dataset, no #> scaling factor is available when using custom: T cells CD4. This cell type will not be re-scaled. #> Finished simulation."},{"path":"/articles/simulator_scaling_factors.html","id":"dataset-specific-scaling-factors","dir":"Articles","previous_headings":"Using scaling factors","what":"Dataset specific scaling factors","title":"Introducing mRNA bias into simulations with scaling factors","text":"can also choose calculate scaling factors, depending provided single-cell dataset. Compared previous section, give unique value cell rather cell-type, making possibly sensitive.","code":""},{"path":"/articles/simulator_scaling_factors.html","id":"reads-and-genes","dir":"Articles","previous_headings":"Using scaling factors > Dataset specific scaling factors","what":"Reads and genes","title":"Introducing mRNA bias into simulations with scaling factors","text":"Two straight forward approaches number reads number expressed genes/features. values easily obtainable provided count data, SimBu already calculates dataset generation. options also allow use numerical measurements single cells scaling factors, weight size example. Lets pretend, add_1 add_2 measurements. additional_cols parameter, can added SimBu dataset can use scaling factor well:","code":"sim_reads <- SimBu::simulate_bulk(data=ds,                             scenario = \"random\",                             scaling_factor=\"read_number\",  # use number of reads as scaling factor                            nsamples = 10,                             ncells=100,                             BPPARAM = BiocParallel::MulticoreParam(workers = 4),                              run_parallel = TRUE) #> Using parallel generation of simulations. #> Finished simulation.  sim_genes <- SimBu::simulate_bulk(data = ds,                            scenario = \"random\",                            scaling_factor = \"expressed_genes\", # use number of expressed genes column as scaling factor                            nsamples = 10,                            ncells = 100,                            BPPARAM = BiocParallel::MulticoreParam(workers = 4),                              run_parallel = TRUE) #> Using parallel generation of simulations. #> Finished simulation. head(annotation) #>       ID   cell_type     spikes     add_1       add_2 #> 1 cell_1 T cells CD4 0.09136481 0.4811858 0.435582586 #> 2 cell_2 T cells CD4 0.61761242 0.6596912 0.358060187 #> 3 cell_3 T cells CD4 0.28130156 0.1950135 0.350385112 #> 4 cell_4 T cells CD4 0.44271955 0.6874199 0.008552276 #> 5 cell_5 T cells CD4 0.69949660 0.2325767 0.595156309 #> 6 cell_6 T cells CD4 0.88835517 0.3133121 0.328329093 ds <- SimBu::dataset(annotation = annotation,                      count_matrix = counts,                      name = \"test_dataset\",                      additional_cols = c('add_1','add_2')) # add columns to dataset #> Filtering genes... #> Created dataset.  sim_genes <- SimBu::simulate_bulk(data = ds,                            scenario = \"random\",                            scaling_factor = \"add_1\", # use add_1 column as scaling factor                            nsamples = 10,                            ncells = 100,                            BPPARAM = BiocParallel::MulticoreParam(workers = 4),                              run_parallel = TRUE) #> Using parallel generation of simulations. #> Scaling by add_1-column in annotation table; if no scaling is wished instead, use 'NONE'. #> Finished simulation."},{"path":"/articles/simulator_scaling_factors.html","id":"spike-ins","dir":"Articles","previous_headings":"Using scaling factors > Dataset specific scaling factors","what":"Spike-ins","title":"Introducing mRNA bias into simulations with scaling factors","text":"One numerical measurement can spike-ins. Usually number reads mapped spike-molecules per cell given cell annotations. case, can stored dataset annotation using spike_in_col parameter, indicate name column annotation dataframe spike-information stored. calculate scaling factor , number reads also necessary, add information well (using read_number_col parameter). scaling factor spike-ins calculated “% reads mapped spike-reads,” : (n_reads - n_spike_in)/n_reads cell. apply like :","code":"ds <- SimBu::dataset(annotation = annotation,                      count_matrix = counts,                      name = \"test_dataset\",                      spike_in_col = 'spikes')    # give the name in the annotation file, that contains spike-in information  sim_spike <- SimBu::simulate_bulk(data = ds,                            scenario = \"random\",                            scaling_factor = \"spike_in\", # use spike-in scaling factor                            nsamples = 10,                            ncells = 100,                            BPPARAM = BiocParallel::MulticoreParam(workers = 4),                              run_parallel = TRUE)"},{"path":"/articles/simulator_scaling_factors.html","id":"census---estimate-mrna-counts-per-cell","dir":"Articles","previous_headings":"Using scaling factors","what":"Census - estimate mRNA counts per cell","title":"Introducing mRNA bias into simulations with scaling factors","text":"Census approach tries convert TPM counts relative transcript counts. basically means, get mRNA counts per cell, can differ cell-types.(Qiu et al. 2017) state paper, applied TPM/FPKM normalized data, tried raw expression counts well, worked well. Census calculates vector scaling value cell sample. can switch feature , setting scaling_factor parameter census. analysis found, Census basically complicated way estimating number expressed genes per cell. remain user decide /wants use census simply number expressed genes (shown ) scaling factor.","code":"ds <- SimBu::dataset(annotation = annotation,                      count_matrix = counts,                      tpm_matrix = tpm,                      name = \"test_dataset\") #> Filtering genes... #> Created dataset.  sim_census <-  SimBu::simulate_bulk(data = ds,                              scenario = \"random\",                               scaling_factor = \"census\",   # use census scaling factor                              nsamples = 10,                               ncells=100,                               BPPARAM = BiocParallel::MulticoreParam(workers = 4),                                run_parallel = TRUE) #> Using parallel generation of simulations. #> Finished simulation. sessionInfo() #> R version 4.1.0 (2021-05-18) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 18.04.6 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 #> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 #>  #> locale: #>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  #>  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #>  #> attached base packages: #> [1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #>  [1] curl_4.3.2                  SeuratObject_4.0.4          Seurat_4.1.0                SimBu_0.99.0                #>  [5] SummarizedExperiment_1.22.0 Biobase_2.52.0              GenomicRanges_1.44.0        GenomeInfoDb_1.28.4         #>  [9] IRanges_2.26.0              S4Vectors_0.30.2            BiocGenerics_0.38.0         MatrixGenerics_1.4.3        #> [13] matrixStats_0.61.0          Matrix_1.3-4                #>  #> loaded via a namespace (and not attached): #>   [1] utf8_1.2.2              reticulate_1.24         RUnit_0.4.32            tidyselect_1.1.2        htmlwidgets_1.5.4       #>   [6] grid_4.1.0              BiocParallel_1.26.2     Rtsne_0.15              munsell_0.5.0           codetools_0.2-18        #>  [11] ica_1.0-2               future_1.24.0           miniUI_0.1.1.1          withr_2.5.0             spatstat.random_2.1-0   #>  [16] colorspace_2.0-3        filelock_1.0.2          highr_0.9               knitr_1.33              rstudioapi_0.13         #>  [21] ROCR_1.0-11             tensor_1.5              listenv_0.8.0           labeling_0.4.2          optparse_1.7.1          #>  [26] GenomeInfoDbData_1.2.6  polyclip_1.10-0         farver_2.1.0            rprojroot_2.0.2         basilisk_1.4.0          #>  [31] parallelly_1.30.0       vctrs_0.3.8             generics_0.1.2          xfun_0.30               R6_2.5.1                #>  [36] bitops_1.0-7            spatstat.utils_2.3-0    cachem_1.0.6            DelayedArray_0.18.0     assertthat_0.2.1        #>  [41] promises_1.2.0.1        scales_1.1.1            gtable_0.3.0            downlit_0.4.0           biocViews_1.60.0        #>  [46] globals_0.14.0          processx_3.5.3          goftest_1.2-3           rlang_1.0.2             splines_4.1.0           #>  [51] lazyeval_0.2.2          spatstat.geom_2.3-2     BiocManager_1.30.16     yaml_2.3.5              reshape2_1.4.4          #>  [56] abind_1.4-5             httpuv_1.6.5            RBGL_1.68.0             tools_4.1.0             ggplot2_3.3.5           #>  [61] ellipsis_0.3.2          spatstat.core_2.4-0     RColorBrewer_1.1-2      ggridges_0.5.3          Rcpp_1.0.8.3            #>  [66] plyr_1.8.7              sparseMatrixStats_1.4.2 zlibbioc_1.38.0         purrr_0.3.4             RCurl_1.98-1.6          #>  [71] basilisk.utils_1.4.0    ps_1.6.0                rpart_4.1-15            deldir_1.0-6            pbapply_1.5-0           #>  [76] cowplot_1.1.1           zoo_1.8-9               ggrepel_0.9.1           cluster_2.1.2           fs_1.5.2                #>  [81] here_1.0.1              magrittr_2.0.1          data.table_1.14.2       scattermore_0.8         lmtest_0.9-40           #>  [86] RANN_2.6.1              fitdistrplus_1.1-8      patchwork_1.1.1         mime_0.10               evaluate_0.14           #>  [91] xtable_1.8-4            XML_4.0-0               gridExtra_2.3           testthat_3.1.2          compiler_4.1.0          #>  [96] tibble_3.1.6            KernSmooth_2.23-20      crayon_1.5.1            htmltools_0.5.2         proxyC_0.2.4            #> [101] mgcv_1.8-36             later_1.3.0             tidyr_1.2.0             RcppParallel_5.1.5      DBI_1.1.2               #> [106] MASS_7.3-54             getopt_1.20.3           brio_1.1.3              cli_3.2.0               igraph_1.2.11           #> [111] pkgconfig_2.0.3         pkgdown_2.0.2           dir.expiry_1.0.0        plotly_4.10.0           spatstat.sparse_2.1-0   #> [116] xml2_1.3.3              stringdist_0.9.8        XVector_0.32.0          BiocCheck_1.28.0        stringr_1.4.0           #> [121] callr_3.7.0             digest_0.6.27           sctransform_0.3.3       RcppAnnoy_0.0.19        graph_1.70.0            #> [126] spatstat.data_2.1-2     rmarkdown_2.13          leiden_0.3.9            uwot_0.1.11             shiny_1.7.1             #> [131] commonmark_1.8.0        lifecycle_1.0.1         nlme_3.1-152            jsonlite_1.7.2          desc_1.4.1              #> [136] viridisLite_0.4.0       fansi_1.0.3             pillar_1.7.0            lattice_0.20-44         fastmap_1.1.0           #> [141] httr_1.4.2              survival_3.2-11         glue_1.6.2              png_0.1-7               stringi_1.6.1           #> [146] memoise_2.0.1           dplyr_1.0.8             irlba_2.3.5             future.apply_1.8.1"},{"path":[]},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Alexander Dietrich. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dietrich (2022). SimBu: Simulate Bulk RNA-seq Datasets Single-Cell Datasets. R package version 0.99.0, https://github.com/omnideconv/SimBu.","code":"@Manual{,   title = {SimBu: Simulate Bulk RNA-seq Datasets from Single-Cell Datasets},   author = {Alexander Dietrich},   year = {2022},   note = {R package version 0.99.0},   url = {https://github.com/omnideconv/SimBu}, }"},{"path":"/index.html","id":"simbu","dir":"","previous_headings":"","what":"Simulate Bulk RNA-seq Datasets from Single-Cell Datasets","title":"Simulate Bulk RNA-seq Datasets from Single-Cell Datasets","text":"goal SimBu simulate pseudo-bulk RNAseq datasets public private single-cell RNAseq datasets.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Simulate Bulk RNA-seq Datasets from Single-Cell Datasets","text":"install package, use following command:","code":"install.packages(\"devtools\") devtools::install_github(\"omnideconv/SimBu\")"},{"path":"/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Simulate Bulk RNA-seq Datasets from Single-Cell Datasets","text":"Create dataset-object local data simulate pseudo-bulk dataset","code":"library(SimBu) # use local data to build dataset dataset <- dataset(annotation = annotation_dataframe, count_matrix = expression_matrix, name = \"test_dataset\") simulation <- simulate_bulk(data = dataset, scenario = \"random\", scaling_factor = \"NONE\")"},{"path":"/reference/calc_scaling_vector.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate scaling factor for a dataset — calc_scaling_vector","title":"Calculate scaling factor for a dataset — calc_scaling_vector","text":"scaling factor default matrix try use (counts TPM). required matrix available, one used warning given.","code":""},{"path":"/reference/calc_scaling_vector.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate scaling factor for a dataset — calc_scaling_vector","text":"","code":"calc_scaling_vector(   data,   scaling_factor,   custom_scaling_vector,   scaling_factor_single_cell,   BPPARAM,   run_parallel )"},{"path":"/reference/calc_scaling_vector.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate scaling factor for a dataset — calc_scaling_vector","text":"data dataset object scaling_factor name scaling factor; possible : census, spike_in, read_number, custom NONE scaling factor custom_scaling_vector named vector custom scaling values cell-types. Cell-types occur vector present dataset set 1 scaling_factor_single_cell boolean: decide scaling value single cell calculated (default) median scaling values cell type calculated BPPARAM BiocParallel::bpparam() default; specific number threads x want used, insert: BiocParallel::MulticoreParam(workers = x) run_parallel boolean, decide multi-threaded calculation run. FALSE default","code":""},{"path":"/reference/calc_scaling_vector.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate scaling factor for a dataset — calc_scaling_vector","text":"named vector scaling value cell dataset","code":""},{"path":"/reference/census.html","id":null,"dir":"Reference","previous_headings":"","what":"Applies the Census count transformation on a count matrix — census","title":"Applies the Census count transformation on a count matrix — census","text":"needs sparse matrix cells columns genes rows. can find detailed explaination : http://cole-trapnell-lab.github.io/monocle-release/docs/#census","code":""},{"path":"/reference/census.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Applies the Census count transformation on a count matrix — census","text":"","code":"census(   matrix,   exp_capture_rate = 0.25,   expr_threshold = 0,   BPPARAM = BiocParallel::bpparam(),   run_parallel = FALSE )"},{"path":"/reference/census.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Applies the Census count transformation on a count matrix — census","text":"matrix sparse count matrix; cells columns, genes rows exp_capture_rate expected capture rate; default=0.25 expr_threshold expression threshold; default=0 BPPARAM BiocParallel::bpparam() default; specific number threads x want used, insert: BiocParallel::MulticoreParam(workers = x) run_parallel boolean, decide multi-threaded calculation run. FALSE default","code":""},{"path":"/reference/census.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Applies the Census count transformation on a count matrix — census","text":"vector cell-type, scaling factor can used transform counts matrix","code":""},{"path":"/reference/census.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Applies the Census count transformation on a count matrix — census","text":"","code":"tpm <- Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) #> Error in rpois(3e+05, 5): could not find function \"rpois\" tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 't': error in evaluating the argument 'x' in selecting a method for function 't': object 'tpm' not found cen <- SimBu::census(tpm) #> Error in SimBu::census(tpm): object 'tpm' not found"},{"path":"/reference/census_monocle.html","id":null,"dir":"Reference","previous_headings":"","what":"Census calculation as implemented in monocle — census_monocle","title":"Census calculation as implemented in monocle — census_monocle","text":"Implementation taken Monocle2: https://github.com/cole-trapnell-lab/monocle-release/blob/master/R/normalization.R#L140","code":""},{"path":"/reference/census_monocle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Census calculation as implemented in monocle — census_monocle","text":"","code":"census_monocle(expr_matrix, exp_capture_rate, expr_threshold)"},{"path":"/reference/census_monocle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Census calculation as implemented in monocle — census_monocle","text":"expr_matrix TPM matrix exp_capture_rate expected capture rate; default=0.25 expr_threshold expression threshold; default=0","code":""},{"path":"/reference/census_monocle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Census calculation as implemented in monocle — census_monocle","text":"vector estimated mRNA values per cell expr_matrix","code":""},{"path":"/reference/check_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"check for correct column names in annotation file and replace them if necessary — check_annotation","title":"check for correct column names in annotation file and replace them if necessary — check_annotation","text":"check correct column names annotation file replace necessary","code":""},{"path":"/reference/check_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"check for correct column names in annotation file and replace them if necessary — check_annotation","text":"","code":"check_annotation(annotation, cell_column = \"cell_type\", id_column = 1)"},{"path":"/reference/check_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"check for correct column names in annotation file and replace them if necessary — check_annotation","text":"annotation dataframe; annotation dataframe cell_column name cell-type column; default \"cell_type\" id_column name cell ID column; default 1, uses rownames","code":""},{"path":"/reference/check_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"check for correct column names in annotation file and replace them if necessary — check_annotation","text":"annotation dataframe correct column names","code":""},{"path":"/reference/check_if_tpm.html","id":null,"dir":"Reference","previous_headings":"","what":"Checks, if a matrix is TPM-like (columns sum up to 1e6) — check_if_tpm","title":"Checks, if a matrix is TPM-like (columns sum up to 1e6) — check_if_tpm","text":"Checks, matrix TPM-like (columns sum 1e6)","code":""},{"path":"/reference/check_if_tpm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Checks, if a matrix is TPM-like (columns sum up to 1e6) — check_if_tpm","text":"","code":"check_if_tpm(tpm_matrix, lower_limit = 7e+05)"},{"path":"/reference/check_if_tpm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Checks, if a matrix is TPM-like (columns sum up to 1e6) — check_if_tpm","text":"tpm_matrix matrix check lower_limit lowest sum value, cell may ","code":""},{"path":"/reference/check_if_tpm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Checks, if a matrix is TPM-like (columns sum up to 1e6) — check_if_tpm","text":"boolean","code":""},{"path":"/reference/compare_matrix_with_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if annotation and matrix have same cells — compare_matrix_with_annotation","title":"Check if annotation and matrix have same cells — compare_matrix_with_annotation","text":"Otherwise intersection used","code":""},{"path":"/reference/compare_matrix_with_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if annotation and matrix have same cells — compare_matrix_with_annotation","text":"","code":"compare_matrix_with_annotation(m, annotation)"},{"path":"/reference/compare_matrix_with_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if annotation and matrix have same cells — compare_matrix_with_annotation","text":"m matrix, column names cells annotation data.frame, rownames genes, cell names ID column","code":""},{"path":"/reference/compare_matrix_with_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if annotation and matrix have same cells — compare_matrix_with_annotation","text":"intersected matrix","code":""},{"path":"/reference/dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Build SummarizedExperiment using local annotation and count matrix R objects — dataset","title":"Build SummarizedExperiment using local annotation and count matrix R objects — dataset","text":"Build SummarizedExperiment using local annotation count matrix R objects","code":""},{"path":"/reference/dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build SummarizedExperiment using local annotation and count matrix R objects — dataset","text":"","code":"dataset(   annotation,   count_matrix = NULL,   tpm_matrix = NULL,   name = \"SimBu_dataset\",   spike_in_col = NULL,   additional_cols = NULL,   filter_genes = TRUE,   variance_cutoff = 0,   type_abundance_cutoff = 0,   scale_tpm = TRUE )"},{"path":"/reference/dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build SummarizedExperiment using local annotation and count matrix R objects — dataset","text":"annotation (mandatory) dataframe; needs columns 'ID' 'cell_type'; 'ID' needs equal cell_names count_matrix count_matrix (mandatory) sparse count matrix; raw count data expected genes rows, cells columns tpm_matrix sparse count matrix; TPM like count data expected genes rows, cells columns name name dataset; used new unique IDs cells spike_in_col column annotation contains information spike_in counts, can used re-scale counts; mandatory spike_in scaling factor simulation additional_cols list column names annotation, stored well dataset object filter_genes boolean, TRUE, removes genes 0 expression samples & genes variance variance_cutoff variance_cutoff numeric, applied filter_genes TRUE: removes genes variance chosen cutoff (default = 0) type_abundance_cutoff numeric, remove cells, whose cell-type appears less given value. removes low abundant cell-types scale_tpm boolean, TRUE (default) cells tpm_matrix scaled sum 1e6","code":""},{"path":"/reference/dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build SummarizedExperiment using local annotation and count matrix R objects — dataset","text":"Return SummarizedExperiment object","code":""},{"path":"/reference/dataset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build SummarizedExperiment using local annotation and count matrix R objects — dataset","text":"","code":"counts <-  Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell_\",rep(1:300)) colnames(tpm) <- paste0(\"cell_\",rep(1:300)) rownames(counts) <- paste0(\"gene_\",rep(1:1000)) rownames(tpm) <- paste0(\"gene_\",rep(1:1000))  annotation <- data.frame(\"ID\" = paste0(\"cell_\",rep(1:300)),                          \"cell_type\" = c(rep(\"T cells CD4\",300)))  ds <- SimBu::dataset(annotation = annotation, count_matrix = counts, tpm_matrix = tpm, name = \"test_dataset\") #> Filtering genes... #> Created dataset."},{"path":"/reference/dataset_h5ad.html","id":null,"dir":"Reference","previous_headings":"","what":"Build SummarizedExperiment using a h5ad file for the counts — dataset_h5ad","title":"Build SummarizedExperiment using a h5ad file for the counts — dataset_h5ad","text":"Build SummarizedExperiment using h5ad file counts","code":""},{"path":"/reference/dataset_h5ad.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build SummarizedExperiment using a h5ad file for the counts — dataset_h5ad","text":"","code":"dataset_h5ad(   h5ad_file_counts,   h5ad_file_tpm = NULL,   cell_id_col = \"ID\",   cell_type_col = \"cell_type\",   cells_in_obs = TRUE,   name = \"SimBu_dataset\",   spike_in_col = NULL,   additional_cols = NULL,   filter_genes = TRUE,   variance_cutoff = 0,   type_abundance_cutoff = 0,   scale_tpm = TRUE )"},{"path":"/reference/dataset_h5ad.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build SummarizedExperiment using a h5ad file for the counts — dataset_h5ad","text":"h5ad_file_counts (mandatory) h5ad file raw count data h5ad_file_tpm h5ad file TPM count data cell_id_col (mandatory) name column Seurat meta.data unique cell ids; 0 rownames cell_type_col (mandatory) name column Seurat meta.data cell type name cells_in_obs boolean, TRUE, cell identifiers taken obs layer anndata object; FALSE, taken var name name dataset; used new unique IDs cells#' @param spike_in_col column annotation contains information spike_in counts, can used re-scale counts; mandatory spike_in scaling factor simulation spike_in_col column annotation contains information spike_in counts, can used re-scale counts; mandatory spike_in scaling factor simulation additional_cols list column names annotation, stored well dataset object filter_genes boolean, TRUE, removes genes 0 expression samples & genes variance variance_cutoff variance_cutoff numeric, applied filter_genes TRUE: removes genes variance chosen cutoff type_abundance_cutoff numeric, remove cells, whose cell-type appears less given value. removes low abundant cell-types scale_tpm boolean, TRUE (default) cells tpm_matrix scaled sum 1e6","code":""},{"path":"/reference/dataset_h5ad.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build SummarizedExperiment using a h5ad file for the counts — dataset_h5ad","text":"Return SummarizedExperiment object","code":""},{"path":"/reference/dataset_h5ad.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build SummarizedExperiment using a h5ad file for the counts — dataset_h5ad","text":"","code":"h5 <- system.file('extdata', 'anndata.h5ad', package='SimBu') ds_h5ad <- SimBu::dataset_h5ad(h5ad_file_counts = h5,                                name = \"h5ad_dataset\",                                cell_id_col = 'ID',                  # this will use the 'ID' column of the metadata as cell identifiers                                cell_type_col = 'cell_type',         # this will use the 'cell-type' column of the metadata as cell type info                                cells_in_obs = TRUE)                 # in case your cell information is stored in the var layer, switch to FALSE #> Filtering genes... #> Created dataset."},{"path":"/reference/dataset_merge.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge multiple SummarizedExperiment datasets into one — dataset_merge","title":"Merge multiple SummarizedExperiment datasets into one — dataset_merge","text":"objects need number assays order work.","code":""},{"path":"/reference/dataset_merge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge multiple SummarizedExperiment datasets into one — dataset_merge","text":"","code":"dataset_merge(   dataset_list,   name = \"SimBu_dataset\",   spike_in_col = NULL,   additional_cols = NULL,   filter_genes = TRUE,   variance_cutoff = 0,   type_abundance_cutoff = 0,   scale_tpm = TRUE )"},{"path":"/reference/dataset_merge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge multiple SummarizedExperiment datasets into one — dataset_merge","text":"dataset_list (mandatory) list SummarizedExperiment objects name name new dataset spike_in_col column annotation contains information spike_in counts, can used re-scale counts; mandatory spike_in scaling factor simulation additional_cols list column names annotation, stored well dataset object filter_genes boolean, TRUE, removes genes 0 expression samples & genes variance variance_cutoff variance_cutoff numeric, applied filter_genes TRUE: removes genes variance chosen cutoff type_abundance_cutoff numeric, remove cells, whose cell-type appears less given value. removes low abundant cell-types scale_tpm boolean, TRUE (default) cells tpm_matrix scaled sum 1e6","code":""},{"path":"/reference/dataset_merge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge multiple SummarizedExperiment datasets into one — dataset_merge","text":"SummarizedExperiment object","code":""},{"path":"/reference/dataset_merge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Merge multiple SummarizedExperiment datasets into one — dataset_merge","text":"","code":"counts <-  Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell_\",rep(1:300)) colnames(tpm) <- paste0(\"cell_\",rep(1:300)) rownames(counts) <- paste0(\"gene_\",rep(1:1000)) rownames(tpm) <- paste0(\"gene_\",rep(1:1000))  annotation <- data.frame(\"ID\" = paste0(\"cell_\",rep(1:300)),                          \"cell_type\" = c(rep(\"T cells CD4\",300)))  ds1 <- SimBu::dataset(annotation = annotation, count_matrix = counts, tpm_matrix = tpm, name = \"test_dataset1\") #> Filtering genes... #> Created dataset. ds2 <- SimBu::dataset(annotation = annotation, count_matrix = counts, tpm_matrix = tpm, name = \"test_dataset2\") #> Filtering genes... #> Created dataset. ds_merged <- SimBu::dataset_merge(list(ds1, ds2)) #> Filtering genes... #> Created dataset."},{"path":"/reference/dataset_seurat.html","id":null,"dir":"Reference","previous_headings":"","what":"Build SummarizedExperiment using a Seurat object — dataset_seurat","title":"Build SummarizedExperiment using a Seurat object — dataset_seurat","text":"Build SummarizedExperiment using Seurat object","code":""},{"path":"/reference/dataset_seurat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build SummarizedExperiment using a Seurat object — dataset_seurat","text":"","code":"dataset_seurat(   seurat_obj,   count_assay,   cell_id_col,   cell_type_col,   tpm_assay = NULL,   name = \"SimBu_dataset\",   spike_in_col = NULL,   additional_cols = NULL,   filter_genes = TRUE,   variance_cutoff = 0,   type_abundance_cutoff = 0,   scale_tpm = TRUE )"},{"path":"/reference/dataset_seurat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build SummarizedExperiment using a Seurat object — dataset_seurat","text":"seurat_obj (mandatory) Seurat object TPM counts count_assay (mandatory) name assay Seurat object contains count data 'counts' slot cell_id_col (mandatory) name column Seurat meta.data unique cell ids cell_type_col (mandatory) name column Seurat meta.data cell type name tpm_assay name assay Seurat object contains TPM data 'counts' slot name name dataset; used new unique IDs cells spike_in_col column annotation contains information spike_in counts, can used re-scale counts; mandatory spike_in scaling factor simulation additional_cols list column names annotation, stored well dataset object filter_genes boolean, TRUE, removes genes 0 expression samples & genes variance variance_cutoff variance_cutoff numeric, applied filter_genes TRUE: removes genes variance chosen cutoff type_abundance_cutoff numeric, remove cells, whose cell-type appears less given value. removes low abundant cell-types scale_tpm boolean, TRUE (default) cells tpm_matrix scaled sum 1e6","code":""},{"path":"/reference/dataset_seurat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build SummarizedExperiment using a Seurat object — dataset_seurat","text":"Return SummarizedExperiment object","code":""},{"path":"/reference/dataset_seurat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build SummarizedExperiment using a Seurat object — dataset_seurat","text":"","code":"counts <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell-\",rep(1:300)) colnames(tpm) <- paste0(\"cell-\",rep(1:300)) rownames(counts) <- paste0(\"gene-\",rep(1:1000)) rownames(tpm) <- paste0(\"gene-\",rep(1:1000))  annotation <- data.frame(\"ID\"=paste0(\"cell-\",rep(1:300)),                           \"cell_type\"=c(rep(\"T cells CD4\",50),                                         rep(\"T cells CD8\",50),                                        rep(\"Macrophages\",100),                                        rep(\"NK cells\",10),                                        rep(\"B cells\",70),                                        rep(\"Monocytes\",20)),                          row.names = paste0(\"cell-\",rep(1:300)))  seurat_obj <- Seurat::CreateSeuratObject(counts = counts, assay = 'counts', meta.data = annotation) tpm_assay <- Seurat::CreateAssayObject(counts = tpm) seurat_obj[['tpm']] <- tpm_assay  ds_seurat <- SimBu::dataset_seurat(seurat_obj = seurat_obj,                                     count_assay = \"counts\",                                     cell_id_col = 'ID',                                     cell_type_col = 'cell_type',                                     tpm_assay = 'tpm',                                    name = \"seurat_dataset\") #> Filtering genes... #> Created dataset."},{"path":"/reference/dataset_sfaira.html","id":null,"dir":"Reference","previous_headings":"","what":"Build SummarizedExperiment using a single sfaira entry ID — dataset_sfaira","title":"Build SummarizedExperiment using a single sfaira entry ID — dataset_sfaira","text":"Build SummarizedExperiment using single sfaira entry ID","code":""},{"path":"/reference/dataset_sfaira.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build SummarizedExperiment using a single sfaira entry ID — dataset_sfaira","text":"","code":"dataset_sfaira(   sfaira_id,   sfaira_setup,   name,   spike_in_col = NULL,   additional_cols = NULL,   force = FALSE,   filter_genes = TRUE,   variance_cutoff = 0,   type_abundance_cutoff = 0,   scale_tpm = TRUE )"},{"path":"/reference/dataset_sfaira.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build SummarizedExperiment using a single sfaira entry ID — dataset_sfaira","text":"sfaira_id (mandatory) ID sfaira dataset sfaira_setup (mandatory) sfaira setup; given setup_sfaira name name dataset; used new unique IDs cells spike_in_col column annotation contains information spike_in counts, can used re-scale counts additional_cols list column names annotation, stored well dataset object force boolean, TRUE, datasets without annotation downloaded, FALSE otherwise (default) filter_genes boolean, TRUE, removes genes 0 expression samples & genes variance variance_cutoff variance_cutoff numeric, applied filter_genes TRUE: removes genes variance chosen cutoff type_abundance_cutoff numeric, remove cells, whose cell-type appears less given value. removes low abundant cell-types scale_tpm boolean, TRUE (default) cells tpm_matrix scaled sum 1e6","code":""},{"path":"/reference/dataset_sfaira.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build SummarizedExperiment using a single sfaira entry ID — dataset_sfaira","text":"dataset object","code":""},{"path":"/reference/dataset_sfaira.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build SummarizedExperiment using a single sfaira entry ID — dataset_sfaira","text":"","code":"if (FALSE) { setup_list <- SimBu::setup_sfaira(tempdir()) ds <- SimBu::dataset_sfaira(sfaira_id = 'homosapiens_lungparenchyma_2019_10x3v2_madissoon_001_10.1186/s13059-019-1906-x',                      sfaira_setup = setup_list,                      name = \"test_dataset\") }"},{"path":"/reference/dataset_sfaira_multiple.html","id":null,"dir":"Reference","previous_headings":"","what":"Build SummarizedExperiment using multiple sfaira entries — dataset_sfaira_multiple","title":"Build SummarizedExperiment using multiple sfaira entries — dataset_sfaira_multiple","text":"can apply different filters whole data-zoo sfaria; resulting single-cell datasets combined single dataset can use simulation Note: datasets sfaira annotation considered!","code":""},{"path":"/reference/dataset_sfaira_multiple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build SummarizedExperiment using multiple sfaira entries — dataset_sfaira_multiple","text":"","code":"dataset_sfaira_multiple(   organisms = NULL,   tissues = NULL,   assays = NULL,   sfaira_setup,   name,   spike_in_col = NULL,   additional_cols = NULL,   filter_genes = TRUE,   variance_cutoff = 0,   type_abundance_cutoff = 0,   scale_tpm = TRUE )"},{"path":"/reference/dataset_sfaira_multiple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build SummarizedExperiment using multiple sfaira entries — dataset_sfaira_multiple","text":"organisms (mandatory) list organisms (human mouse available) tissues (mandatory) list tissues assays (mandatory) list assays sfaira_setup (mandatory) sfaira setup; given setup_sfaira name name dataset; used new unique IDs cells spike_in_col column annotation contains information spike_in counts, can used re-scale counts additional_cols list column names annotation, stored well dataset object filter_genes boolean, TRUE, removes genes 0 expression samples & genes variance variance_cutoff variance_cutoff numeric, applied filter_genes TRUE: removes genes variance chosen cutoff type_abundance_cutoff numeric, remove cells, whose cell-type appears less given value. removes low abundant cell-types scale_tpm boolean, TRUE (default) cells tpm_matrix scaled sum 1e6","code":""},{"path":"/reference/dataset_sfaira_multiple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build SummarizedExperiment using multiple sfaira entries — dataset_sfaira_multiple","text":"dataset object","code":""},{"path":"/reference/dataset_sfaira_multiple.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build SummarizedExperiment using multiple sfaira entries — dataset_sfaira_multiple","text":"","code":"if (FALSE) { setup_list <- SimBu::setup_sfaira(tempdir()) ds_human_pancreas <- SimBu::dataset_sfaira_multiple(sfaira_setup = setup_list,                                                     organisms = \"Homo sapiens\",                                                     tissues = \"pancreas\",                                                     name = \"human_pancreas\") }"},{"path":"/reference/dmode.html","id":null,"dir":"Reference","previous_headings":"","what":"use gaussian kernel to calculate the mode of transcript counts — dmode","title":"use gaussian kernel to calculate the mode of transcript counts — dmode","text":"use gaussian kernel calculate mode transcript counts","code":""},{"path":"/reference/dmode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"use gaussian kernel to calculate the mode of transcript counts — dmode","text":"","code":"dmode(x)"},{"path":"/reference/dmode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"use gaussian kernel to calculate the mode of transcript counts — dmode","text":"x vector numeric values","code":""},{"path":"/reference/dmode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"use gaussian kernel to calculate the mode of transcript counts — dmode","text":"commonly occurring (log-transformed) TPM value","code":""},{"path":"/reference/download_sfaira.html","id":null,"dir":"Reference","previous_headings":"","what":"download a specific dataset from sfaira by an ID — download_sfaira","title":"download a specific dataset from sfaira by an ID — download_sfaira","text":"download specific dataset sfaira ID","code":""},{"path":"/reference/download_sfaira.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"download a specific dataset from sfaira by an ID — download_sfaira","text":"","code":"download_sfaira(   setup_list,   id,   force = FALSE,   synapse_user = NULL,   synapse_pw = NULL )"},{"path":"/reference/download_sfaira.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"download a specific dataset from sfaira by an ID — download_sfaira","text":"setup_list sfaira setup; given setup_sfaira id ID datasets force logical; TRUE want force download, even though cell-type annotation exists dataset. Default FALSE synapse_user character; username synapse portal (https://www.synapse.org) synapse_pw character; password synapse portal (https://www.synapse.org)","code":""},{"path":"/reference/download_sfaira.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"download a specific dataset from sfaira by an ID — download_sfaira","text":"matrix, gene names cell IDs","code":""},{"path":"/reference/download_sfaira_multiple.html","id":null,"dir":"Reference","previous_headings":"","what":"download multiple datasets from sfaira using filters for organism, tissue and/or assay — download_sfaira_multiple","title":"download multiple datasets from sfaira using filters for organism, tissue and/or assay — download_sfaira_multiple","text":"similar filters sfaira website (https://theislab.github.io/sfaira-portal/Datasets)","code":""},{"path":"/reference/download_sfaira_multiple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"download multiple datasets from sfaira using filters for organism, tissue and/or assay — download_sfaira_multiple","text":"","code":"download_sfaira_multiple(   setup_list,   organisms = NULL,   tissues = NULL,   assays = NULL,   force = FALSE )"},{"path":"/reference/download_sfaira_multiple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"download multiple datasets from sfaira using filters for organism, tissue and/or assay — download_sfaira_multiple","text":"setup_list sfaira setup; given setup_sfaira organisms list organisms (human mouse available) tissues list tissues assays list assays force logical; TRUE want force download datasets, otherwise ones cell-type annotation returned. Default FALSE","code":""},{"path":"/reference/download_sfaira_multiple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"download multiple datasets from sfaira using filters for organism, tissue and/or assay — download_sfaira_multiple","text":"annotated data object, contains count matrix annotation","code":""},{"path":"/reference/filter_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"filter one (or two) expression matrix by genes — filter_matrix","title":"filter one (or two) expression matrix by genes — filter_matrix","text":"filter one (two) expression matrix genes","code":""},{"path":"/reference/filter_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filter one (or two) expression matrix by genes — filter_matrix","text":"","code":"filter_matrix(m1, m2 = NULL, filter_genes = TRUE, variance_cutoff = 0)"},{"path":"/reference/filter_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filter one (or two) expression matrix by genes — filter_matrix","text":"m1 Matrix 1 m2 Matrix 2 (optional) filter_genes boolean variance_cutoff numeric, genes variance value removed","code":""},{"path":"/reference/filter_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"filter one (or two) expression matrix by genes — filter_matrix","text":"filtered matrix","code":""},{"path":"/reference/generate_summarized_experiment.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate SummarizedExperiment using multiple parameters — generate_summarized_experiment","title":"Generate SummarizedExperiment using multiple parameters — generate_summarized_experiment","text":"Generate SummarizedExperiment using multiple parameters","code":""},{"path":"/reference/generate_summarized_experiment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate SummarizedExperiment using multiple parameters — generate_summarized_experiment","text":"","code":"generate_summarized_experiment(   annotation,   count_matrix,   tpm_matrix,   name,   spike_in_col,   additional_cols,   filter_genes,   variance_cutoff,   type_abundance_cutoff,   scale_tpm )"},{"path":"/reference/generate_summarized_experiment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate SummarizedExperiment using multiple parameters — generate_summarized_experiment","text":"annotation (mandatory) dataframe; needs columns 'ID' 'cell_type'; 'ID' needs equal cell_names count_matrix count_matrix (mandatory) sparse count matrix; raw count data expected genes rows, cells columns tpm_matrix sparse count matrix; TPM like count data expected genes rows, cells columns name name dataset; used new unique IDs cells spike_in_col column annotation contains information spike_in counts, can used re-scale counts; mandatory spike_in scaling factor simulation additional_cols list column names annotation, stored well dataset object filter_genes boolean, TRUE, removes genes 0 expression samples & genes variance variance_cutoff variance_cutoff numeric, applied filter_genes TRUE: removes genes variance chosen cutoff type_abundance_cutoff numeric, remove cells, whose cell-type appears less given value. removes low abundant cell-types scale_tpm boolean, TRUE (default) cells tpm_matrix scaled sum 1e6","code":""},{"path":"/reference/generate_summarized_experiment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate SummarizedExperiment using multiple parameters — generate_summarized_experiment","text":"Return SummarizedExperiment object","code":""},{"path":"/reference/h5ad_to_adata.html","id":null,"dir":"Reference","previous_headings":"","what":"Use basilisk environment to read h5ad file and access anndata object — h5ad_to_adata","title":"Use basilisk environment to read h5ad file and access anndata object — h5ad_to_adata","text":"Use basilisk environment read h5ad file access anndata object","code":""},{"path":"/reference/h5ad_to_adata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use basilisk environment to read h5ad file and access anndata object — h5ad_to_adata","text":"","code":"h5ad_to_adata(h5ad_path, cells_in_obs)"},{"path":"/reference/h5ad_to_adata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use basilisk environment to read h5ad file and access anndata object — h5ad_to_adata","text":"h5ad_path path h5ad file cells_in_obs boolean, TRUE, cell identifiers taken obs layer anndata object; FALSE, taken var","code":""},{"path":"/reference/h5ad_to_adata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use basilisk environment to read h5ad file and access anndata object — h5ad_to_adata","text":"matrix contained h5ad file dgCMatrix","code":""},{"path":"/reference/merge_scaling_factor.html","id":null,"dir":"Reference","previous_headings":"","what":"Create scaling vector from custom or pre-defined scaling factor — merge_scaling_factor","title":"Create scaling vector from custom or pre-defined scaling factor — merge_scaling_factor","text":"Create scaling vector custom pre-defined scaling factor","code":""},{"path":"/reference/merge_scaling_factor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create scaling vector from custom or pre-defined scaling factor — merge_scaling_factor","text":"","code":"merge_scaling_factor(data, scaling_factor_values, scaling_factor_name)"},{"path":"/reference/merge_scaling_factor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create scaling vector from custom or pre-defined scaling factor — merge_scaling_factor","text":"data dataset scaling_factor_values named list scaling values scaling_factor_name name scaling factor method","code":""},{"path":"/reference/merge_scaling_factor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create scaling vector from custom or pre-defined scaling factor — merge_scaling_factor","text":"scaling vector","code":""},{"path":"/reference/merge_simulations.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine multiple simulations into one result — merge_simulations","title":"Combine multiple simulations into one result — merge_simulations","text":"recommend merge simulations dataset object, otherwise count matrices might correspond gene level","code":""},{"path":"/reference/merge_simulations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine multiple simulations into one result — merge_simulations","text":"","code":"merge_simulations(simulation_list)"},{"path":"/reference/merge_simulations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine multiple simulations into one result — merge_simulations","text":"simulation_list list simulations","code":""},{"path":"/reference/merge_simulations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine multiple simulations into one result — merge_simulations","text":"named list; bulk SummarizedExperiment object, assays store simulated bulk RNAseq datasets. Can hold either one two assays, depending many matrices present dataset cell-fractions dataframe simulated cell-fractions per sample; scaling_vector scaling value cell dataset","code":""},{"path":"/reference/merge_simulations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine multiple simulations into one result — merge_simulations","text":"","code":"counts <- Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) #> Error in rpois(3e+05, 5): could not find function \"rpois\" tpm <- Matrix::Matrix(matrix(rpois(3e5, 5), ncol=300), sparse = TRUE) #> Error in rpois(3e+05, 5): could not find function \"rpois\" tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 't': error in evaluating the argument 'x' in selecting a method for function 't': object 'tpm' not found  colnames(counts) <- paste0(\"cell_\",rep(1:300)) #> Error in colnames(counts) <- paste0(\"cell_\", rep(1:300)): object 'counts' not found colnames(tpm) <- paste0(\"cell_\",rep(1:300)) #> Error in colnames(tpm) <- paste0(\"cell_\", rep(1:300)): object 'tpm' not found rownames(counts) <- paste0(\"gene_\",rep(1:1000)) #> Error in rownames(counts) <- paste0(\"gene_\", rep(1:1000)): object 'counts' not found rownames(tpm) <- paste0(\"gene_\",rep(1:1000)) #> Error in rownames(tpm) <- paste0(\"gene_\", rep(1:1000)): object 'tpm' not found  annotation <- data.frame(\"ID\"=paste0(\"cell_\",rep(1:300)),                          \"cell_type\"=c(rep(\"T cells CD4\",50),                                        rep(\"T cells CD8\",50),                                        rep(\"Macrophages\",100),                                        rep(\"NK cells\",10),                                        rep(\"B cells\",70),                                        rep(\"Monocytes\",20)))  dataset <- SimBu::dataset(annotation = annotation,                           count_matrix = counts,                           tpm_matrix = tpm,                           name = \"test_dataset\") #> Error in generate_summarized_experiment(annotation = annotation, count_matrix = count_matrix,     tpm_matrix = tpm_matrix, name = name, spike_in_col = spike_in_col,     additional_cols = additional_cols, filter_genes = filter_genes,     variance_cutoff = variance_cutoff, type_abundance_cutoff = type_abundance_cutoff,     scale_tpm = scale_tpm): object 'counts' not found  s1 <- SimBu::simulate_bulk(dataset,                           scenario=\"even\",                           scaling_factor=\"NONE\",                           nsamples=10,                           ncells=100) #> Error in (function (classes, fdef, mtable) {    methods <- .findInheritedMethods(classes, fdef, mtable)    if (length(methods) == 1L)         return(methods[[1L]])    else if (length(methods) == 0L) {        cnames <- paste0(\"\\\"\", vapply(classes, as.character,             \"\"), \"\\\"\", collapse = \", \")        stop(gettextf(\"unable to find an inherited method for function %s for signature %s\",             sQuote(fdef@generic), sQuote(cnames)), domain = NA)    }    else stop(\"Internal error in finding inherited methods; didn't return a unique method\",         domain = NA)})(list(\"function\"), new(\"standardGeneric\", .Data = function (x,     ...) standardGeneric(\"colData\"), generic = structure(\"colData\", package = \"SummarizedExperiment\"),     package = \"SummarizedExperiment\", group = list(), valueClass = character(0),     signature = \"x\", default = NULL, skeleton = (function (x,         ...)     stop(\"invalid call in method dispatch to 'colData' (no default method)\",         domain = NA))(x, ...)), <environment>): unable to find an inherited method for function ‘colData’ for signature ‘\"function\"’  s2 <- SimBu::simulate_bulk(dataset,                           scenario=\"even\",                           scaling_factor=\"NONE\",                           nsamples=10,                           ncells=100) #> Error in (function (classes, fdef, mtable) {    methods <- .findInheritedMethods(classes, fdef, mtable)    if (length(methods) == 1L)         return(methods[[1L]])    else if (length(methods) == 0L) {        cnames <- paste0(\"\\\"\", vapply(classes, as.character,             \"\"), \"\\\"\", collapse = \", \")        stop(gettextf(\"unable to find an inherited method for function %s for signature %s\",             sQuote(fdef@generic), sQuote(cnames)), domain = NA)    }    else stop(\"Internal error in finding inherited methods; didn't return a unique method\",         domain = NA)})(list(\"function\"), new(\"standardGeneric\", .Data = function (x,     ...) standardGeneric(\"colData\"), generic = structure(\"colData\", package = \"SummarizedExperiment\"),     package = \"SummarizedExperiment\", group = list(), valueClass = character(0),     signature = \"x\", default = NULL, skeleton = (function (x,         ...)     stop(\"invalid call in method dispatch to 'colData' (no default method)\",         domain = NA))(x, ...)), <environment>): unable to find an inherited method for function ‘colData’ for signature ‘\"function\"’  s <- SimBu::merge_simulations(list(s1,s2)) #> Error in SimBu::merge_simulations(list(s1, s2)): object 's1' not found"},{"path":"/reference/plot_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the cell-type fractions in your simulated dataset — plot_simulation","title":"Plot the cell-type fractions in your simulated dataset — plot_simulation","text":"Plot cell-type fractions simulated dataset","code":""},{"path":"/reference/plot_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the cell-type fractions in your simulated dataset — plot_simulation","text":"","code":"plot_simulation(simulation)"},{"path":"/reference/plot_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the cell-type fractions in your simulated dataset — plot_simulation","text":"simulation simulation object generated simulate_bulk","code":""},{"path":"/reference/plot_simulation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the cell-type fractions in your simulated dataset — plot_simulation","text":"gpplot2 barplot","code":""},{"path":"/reference/plot_simulation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the cell-type fractions in your simulated dataset — plot_simulation","text":"","code":"counts <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell_\",rep(1:300)) colnames(tpm) <- paste0(\"cell_\",rep(1:300)) rownames(counts) <- paste0(\"gene_\",rep(1:1000)) rownames(tpm) <- paste0(\"gene_\",rep(1:1000))  annotation <- data.frame(\"ID\"=paste0(\"cell_\",rep(1:300)),                          \"cell_type\"=c(rep(\"T cells CD4\",50),                                        rep(\"T cells CD8\",50),                                        rep(\"Macrophages\",100),                                        rep(\"NK cells\",10),                                        rep(\"B cells\",70),                                        rep(\"Monocytes\",20)))  dataset <- SimBu::dataset(annotation = annotation,                           count_matrix = counts,                           tpm_matrix = tpm,                           name = \"test_dataset\") #> Filtering genes... #> Created dataset.  s <- SimBu::simulate_bulk(dataset,                           scenario=\"even\",                           scaling_factor=\"NONE\",                           nsamples=10,                           ncells=100) #> Finished simulation.  SimBu::plot_simulation(s) #> Error in rgb(c(166, 31, 178, 51, 251, 227, 253, 255, 202), c(206, 120,     223, 160, 154, 26, 191, 127, 178), c(227, 180, 138, 44, 153,     28, 111, 0, 214), maxColorValue = 255): could not find function \"rgb\""},{"path":"/reference/save_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Save the expression matrix of a simulated pseudo-bulk dataset to a file — save_simulation","title":"Save the expression matrix of a simulated pseudo-bulk dataset to a file — save_simulation","text":"Save expression matrix simulated pseudo-bulk dataset file","code":""},{"path":"/reference/save_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save the expression matrix of a simulated pseudo-bulk dataset to a file — save_simulation","text":"","code":"save_simulation(simulation, filename, assay = \"bulk_counts\")"},{"path":"/reference/save_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save the expression matrix of a simulated pseudo-bulk dataset to a file — save_simulation","text":"simulation result simulate_bulk() filename filename save expression matrix assay name assay simulation save, default bulk_counts","code":""},{"path":"/reference/save_simulation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save the expression matrix of a simulated pseudo-bulk dataset to a file — save_simulation","text":"write file","code":""},{"path":"/reference/save_simulation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save the expression matrix of a simulated pseudo-bulk dataset to a file — save_simulation","text":"","code":"counts <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell_\",rep(1:300)) colnames(tpm) <- paste0(\"cell_\",rep(1:300)) rownames(counts) <- paste0(\"gene_\",rep(1:1000)) rownames(tpm) <- paste0(\"gene_\",rep(1:1000))  annotation <- data.frame(\"ID\"=paste0(\"cell_\",rep(1:300)),                          \"cell_type\"=c(rep(\"T cells CD4\",50),                                        rep(\"T cells CD8\",50),                                        rep(\"Macrophages\",100),                                        rep(\"NK cells\",10),                                        rep(\"B cells\",70),                                        rep(\"Monocytes\",20)))  dataset <- SimBu::dataset(annotation = annotation,                           count_matrix = counts,                           tpm_matrix = tpm,                           name = \"test_dataset\") #> Filtering genes... #> Created dataset.  s <- SimBu::simulate_bulk(dataset,                           scenario=\"even\",                           scaling_factor=\"NONE\",                           nsamples=10,                           ncells=100) #> Finished simulation.                             save_simulation(s, tempfile())"},{"path":"/reference/setup_sfaira.html","id":null,"dir":"Reference","previous_headings":"","what":"setup the sfaira package — setup_sfaira","title":"setup the sfaira package — setup_sfaira","text":"want download datasets Sfaira, need specify directory datasets saved . Additionally, function called first time, conda environment established sfaira along dependencies installed. can take time performed one single time, environment can re-used.","code":""},{"path":"/reference/setup_sfaira.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"setup the sfaira package — setup_sfaira","text":"","code":"setup_sfaira(basedir)"},{"path":"/reference/setup_sfaira.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"setup the sfaira package — setup_sfaira","text":"basedir name directory, raw files downloaded ","code":""},{"path":"/reference/setup_sfaira.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"setup the sfaira package — setup_sfaira","text":"list sfaira file directories; must used input sfaira based functions","code":""},{"path":"/reference/setup_sfaira.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"setup the sfaira package — setup_sfaira","text":"","code":"if (FALSE) { sfaira_list <- setup_sfaira(basedir=tempdir()) }"},{"path":"/reference/sfaira_overview.html","id":null,"dir":"Reference","previous_headings":"","what":"Gives an overview of the possible datasets you can use from the sfaira database — sfaira_overview","title":"Gives an overview of the possible datasets you can use from the sfaira database — sfaira_overview","text":"Gives overview possible datasets can use sfaira database","code":""},{"path":"/reference/sfaira_overview.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gives an overview of the possible datasets you can use from the sfaira database — sfaira_overview","text":"","code":"sfaira_overview(setup_list)"},{"path":"/reference/sfaira_overview.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gives an overview of the possible datasets you can use from the sfaira database — sfaira_overview","text":"setup_list sfaira setup; given setup_sfaira","code":""},{"path":"/reference/sfaira_overview.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gives an overview of the possible datasets you can use from the sfaira database — sfaira_overview","text":"dataframe information dataset","code":""},{"path":"/reference/sfaira_overview.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gives an overview of the possible datasets you can use from the sfaira database — sfaira_overview","text":"","code":"if (FALSE) all_datasets <- sfaira_overview(setup_list)"},{"path":"/reference/simulate_bulk.html","id":null,"dir":"Reference","previous_headings":"","what":"simulate whole pseudo-bulk RNAseq dataset — simulate_bulk","title":"simulate whole pseudo-bulk RNAseq dataset — simulate_bulk","text":"function allows create full pseudo-bulk RNAseq dataset. need provide SummarizedExperiment cells sampled simulation. Also scenario selected, can choose cells sampled scaling_factor read counts transformed proir simulation.","code":""},{"path":"/reference/simulate_bulk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulate whole pseudo-bulk RNAseq dataset — simulate_bulk","text":"","code":"simulate_bulk(   data,   scenario = c(\"even\", \"random\", \"mirror_db\", \"weighted\", \"pure\", \"custom\"),   scaling_factor = c(\"NONE\", \"census\", \"spike_in\", \"custom\", \"read_number\",     \"expressed_genes\", \"annotation_column\", \"epic\", \"abis\", \"quantiseq\"),   scaling_factor_single_cell = TRUE,   weighted_cell_type = NULL,   weighted_amount = NULL,   pure_cell_type = NULL,   custom_scenario_data = NULL,   custom_scaling_vector = NULL,   balance_even_mirror_scenario = 0.01,   remove_bias_in_counts = TRUE,   remove_bias_in_counts_method = \"read-number\",   norm_counts = FALSE,   nsamples = 100,   ncells = 1000,   total_read_counts = NULL,   whitelist = NULL,   blacklist = NULL,   BPPARAM = BiocParallel::bpparam(),   run_parallel = FALSE )"},{"path":"/reference/simulate_bulk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulate whole pseudo-bulk RNAseq dataset — simulate_bulk","text":"data (mandatory) SummarizedExperiment object scenario (mandatory) select pre-defined cell-type fraction scenarios; possible : even,random,mirror_db,pure,weighted; can also use custom scenario, need set custom_scenario_data parameter. scaling_factor (mandatory) name scaling factor; possible : census, spike_in, read_number, expressed_genes, custom, epic, abis, quantiseq NONE scaling factor scaling_factor_single_cell boolean: decide scaling value single cell calculated (default) median scaling values cell type calculated weighted_cell_type name cell-type used weighted scenario weighted_amount fraction cell-type used weighted scenario; must 0 0.99 pure_cell_type name cell-type pure scenario custom_scenario_data dataframe; needs size nsamples x number_of_cell_types, sample row entry cell-type fraction. Rows need sum 1. custom_scaling_vector named vector custom scaling values cell-types. Cell-types occur vector present dataset set 1; mandatory custom scaling factor balance_even_mirror_scenario balancing value uniform mirror_db scenarios: increasing result diverse simulated fractions. get fractions sample, set 0. Default 0.01. remove_bias_in_counts boolean; TRUE (default) internal mRNA bias present count data removed using number reads mapped cell remove_bias_in_counts_method 'read-number' (default) 'gene-number'; method mRNA bias counts removed norm_counts boolean; TRUE samples simulated counts normalized CPMs, default FALSE nsamples numeric; number samples pseudo-bulk RNAseq dataset (default = 100) ncells numeric; number cells dataset (default = 1000) total_read_counts numeric; sets total read count value sample whitelist list; give list cell-types want keep simulation; NULL, used blacklist list; give list cell-types want remove simulation; NULL, used; applied whitelist BPPARAM BiocParallel::bpparam() default; specific number threads x want used, insert: BiocParallel::MulticoreParam(workers = x) run_parallel boolean, decide multi-threaded calculation run. FALSE default","code":""},{"path":"/reference/simulate_bulk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simulate whole pseudo-bulk RNAseq dataset — simulate_bulk","text":"named list; bulk SummarizedExperiment object, assays store simulated bulk RNAseq datasets. Can hold either one two assays, depending many matrices present dataset cell-fractions dataframe simulated cell-fractions per sample; scaling_vector scaling value cell dataset","code":""},{"path":"/reference/simulate_bulk.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simulate whole pseudo-bulk RNAseq dataset — simulate_bulk","text":"","code":"#generate sample single-cell data to work with:  counts <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::Matrix(matrix(stats::rpois(3e5, 5), ncol=300), sparse = TRUE) tpm <- Matrix::t(1e6*Matrix::t(tpm)/Matrix::colSums(tpm))  colnames(counts) <- paste0(\"cell_\",rep(1:300)) colnames(tpm) <- paste0(\"cell_\",rep(1:300)) rownames(counts) <- paste0(\"gene_\",rep(1:1000)) rownames(tpm) <- paste0(\"gene_\",rep(1:1000))  annotation <- data.frame(\"ID\"=paste0(\"cell_\",rep(1:300)),                          \"cell_type\"=c(rep(\"T cells CD4\",50),                                        rep(\"T cells CD8\",50),                                        rep(\"Macrophages\",100),                                        rep(\"NK cells\",10),                                        rep(\"B cells\",70),                                        rep(\"Monocytes\",20)))  dataset <- SimBu::dataset(annotation = annotation,                           count_matrix = counts,                           tpm_matrix = tpm,                           name = \"test_dataset\") #> Filtering genes... #> Created dataset.  # this creates a basic pseudo-bulk dataset with uniform cell-type distribution # and no additional transformation of the data with 10 samples and 2000 cells each  s<-SimBu::simulate_bulk(dataset,               scenario=\"even\",               scaling_factor=\"NONE\",               nsamples=10,               ncells=100) #> Finished simulation.  # use a blacklist to exclude certain cell-types for the simulation s<-SimBu::simulate_bulk(dataset,               scenario=\"even\",               scaling_factor=\"NONE\",               nsamples=10,               ncells=2000,               blacklist=c(\"Monocytes\",\"Macrophages\")) #> Finished simulation.   # use the pure scenario to only have B cells s<-SimBu::simulate_bulk(dataset,               scenario=\"pure\",               scaling_factor=\"NONE\",               nsamples=10,               ncells=100,               pure_cell_type=\"B cells\") #> Finished simulation.  # simulate a dataset with custom cell-type fraction for each of the 3 samples fractions <- data.frame(\"B cells\"=c(0.2,0.4,0.2),                         \"T cells CD4\"=c(0.4,0.2,0.1),                         \"Macrophages\"=c(0.4,0.4,0.7), check.names = FALSE) s<-SimBu::simulate_bulk(dataset,               scenario=\"custom\",               scaling_factor=\"NONE\",               nsamples=3,               ncells=2000,               custom_scenario_data=fractions) #> Finished simulation."},{"path":"/reference/simulate_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"simulate single pseudo-bulk sample — simulate_sample","title":"simulate single pseudo-bulk sample — simulate_sample","text":"function sample cells according given cell-type fractions. creates single pseudo-bulk sample calculating mean expression value per gene sampled cells. Note: total_read_counts used, cell-fractions applied number counts, number cells!","code":""},{"path":"/reference/simulate_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulate single pseudo-bulk sample — simulate_sample","text":"","code":"simulate_sample(   data,   scaling_vector,   simulation_vector,   total_cells,   total_read_counts,   remove_bias_in_counts,   remove_bias_in_counts_method,   norm_counts )"},{"path":"/reference/simulate_sample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulate single pseudo-bulk sample — simulate_sample","text":"data SummarizedExperiment object scaling_vector vector scaling values cell; calculated calc_scaling_vector function simulation_vector named vector wanted cell-types fractions total_cells numeric; number total cells simulation total_read_counts numeric; sets total read count value sample remove_bias_in_counts boolean; TRUE (default) internal mRNA bias present count data removed using number reads mapped cell remove_bias_in_counts_method 'read-number' (default) 'gene-number'; method mRNA bias counts removed norm_counts boolean; TRUE samples simulated counts normalized CPMs, default FALSE","code":""},{"path":"/reference/simulate_sample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simulate single pseudo-bulk sample — simulate_sample","text":"returns two vectors (one based counts, one based tpm; depends matrices present data) expression values genes provided dataset","code":""},{"path":[]},{"path":"/news/index.html","id":"new-features-0-1-0","dir":"Changelog","previous_headings":"","what":"New features","title":"SimBu 0.1.0","text":"First version SimBu.","code":""},{"path":[]},{"path":"/news/index.html","id":"bioconductor-submission-0-99-0","dir":"Changelog","previous_headings":"","what":"Bioconductor Submission","title":"SimBu 0.99.0","text":"submitted package Bioconductor","code":""},{"path":"/news/index.html","id":"use-basilisk-to-solve-conda-environment-and-sfaira-dependencies-0-99-0","dir":"Changelog","previous_headings":"","what":"Use basilisk to solve conda environment and Sfaira dependencies","title":"SimBu 0.99.0","text":"removes manual installation Sfaira","code":""}]
